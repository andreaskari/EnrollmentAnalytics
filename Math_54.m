%% Extracting Data

% This data is taken from ninja courses and is the data of the fastest filling 
% Math 54 lecture per respective semester.
clear all
close all
clc
% Source strings from NinjaCourses code
spring14unextracted = '0%2C450%2C0%0A1381276800%2C0%2C450%2C0%0A1381363200%2C0%2C450%2C0%0A1381449600%2C0%2C450%2C0%0A1381536000%2C0%2C450%2C0%0A1381622400%2C0%2C450%2C0%0A1381708800%2C0%2C450%2C0%0A1381795200%2C0%2C450%2C0%0A1381881600%2C0%2C450%2C0%0A1381968000%2C0%2C450%2C0%0A1382054400%2C0%2C450%2C0%0A1382140800%2C0%2C450%2C0%0A1382227200%2C0%2C450%2C0%0A1382313600%2C0%2C450%2C0%0A1382400000%2C0%2C450%2C0%0A1382400000%2C52%2C450%2C0%0A1382486400%2C52%2C450%2C0%0A1382572800%2C67%2C450%2C0%0A1382659200%2C73%2C450%2C0%0A1382745600%2C79%2C450%2C0%0A1382832000%2C99%2C450%2C0%0A1382918400%2C99%2C450%2C0%0A1383004800%2C100%2C450%2C0%0A1383091200%2C102%2C450%2C0%0A1383177600%2C106%2C450%2C0%0A1383264000%2C133%2C450%2C0%0A1383350400%2C223%2C450%2C0%0A1383436800%2C268%2C450%2C0%0A1383523200%2C268%2C450%2C0%0A1383609600%2C275%2C450%2C0%0A1383696000%2C405%2C450%2C26%0A1383782400%2C442%2C450%2C50%0A1383868800%2C446%2C450%2C50%0A1383955200%2C446%2C450%2C50%0A1384041600%2C445%2C450%2C50%0A1384128000%2C445%2C450%2C50%0A1384214400%2C448%2C450%2C50%0A1384300800%2C447%2C450%2C50%0A1384387200%2C447%2C450%2C50%0A1384473600%2C447%2C450%2C50%0A1384560000%2C447%2C450%2C50%0A1384646400%2C449%2C450%2C48%0A1384732800%2C449%2C450%2C48%0A1384819200%2C449%2C450%2C50%0A1384905600%2C448%2C450%2C50%0A1384992000%2C447%2C450%2C50%0A1385078400%2C446%2C450%2C50%0A1385164800%2C449%2C450%2C49%0A1385251200%2C449%2C450%2C50%0A1385337600%2C449%2C450%2C50%0A1385424000%2C449%2C450%2C50%0A1385510400%2C447%2C450%2C50%0A1385596800%2C446%2C450%2C50%0A1385683200%2C445%2C450%2C50%0A1385769600%2C449%2C450%2C47%0A1385856000%2C449%2C450%2C49%0A1385942400%2C449%2C450%2C49%0A1386028800%2C448%2C450%2C50%0A1386115200%2C448%2C450%2C50%0A1386201600%2C445%2C450%2C50%0A1386288000%2C450%2C450%2C50%0A1386374400%2C450%2C450%2C50%0A1386460800%2C468%2C475%2C49%0A1386547200%2C468%2C475%2C49%0A1386633600%2C475%2C475%2C50%0A1386720000%2C475%2C475%2C50%0A1386806400%2C475%2C500%2C50%0A1386892800%2C474%2C500%2C50%0A1386979200%2C476%2C500%2C50%0A1387065600%2C484%2C500%2C46%0A1387152000%2C484%2C500%2C46%0A1387238400%2C498%2C500%2C49%0A1387324800%2C500%2C500%2C49%0A1387411200%2C497%2C500%2C50%0A1387497600%2C497%2C500%2C50%0A1387584000%2C497%2C500%2C50%0A1387670400%2C500%2C500%2C47%0A1387756800%2C500%2C500%2C47%0A1387843200%2C499%2C500%2C50%0A1387929600%2C499%2C500%2C50%0A1388016000%2C499%2C500%2C50%0A1388102400%2C498%2C500%2C50%0A1388188800%2C497%2C500%2C50%0A1388275200%2C500%2C500%2C47%0A1388361600%2C500%2C500%2C47%0A1388448000%2C500%2C500%2C49%0A1388534400%2C500%2C500%2C50%0A1388620800%2C499%2C500%2C50%0A1388707200%2C499%2C500%2C50%0A1388793600%2C499%2C500%2C50%0A1388880000%2C500%2C500%2C49%0A1388966400%2C500%2C500%2C49%0A1389052800%2C499%2C500%2C50%0A1389139200%2C497%2C500%2C50%0A1389225600%2C495%2C500%2C50%0A1389312000%2C499%2C500%2C45%0A1389398400%2C499%2C500%2C48%0A1389571200%2C499%2C500%2C50%0A1389657600%2C500%2C500%2C50%0A1389744000%2C500%2C500%2C50%0A1389830400%2C500%2C500%2C47%0A1389916800%2C525%2C527%2C30%0A1390003200%2C525%2C527%2C35%0A1390089600%2C527%2C527%2C36%0A1390176000%2C527%2C527%2C36%0A1390262400%2C524%2C527%2C43%0A1390348800%2C527%2C527%2C46%0A1390435200%2C524%2C527%2C50%0A1390521600%2C524%2C527%2C50%0A1390608000%2C527%2C527%2C47%0A1390694400%2C527%2C527%2C47%0A1390780800%2C527%2C527%2C47%0A1390953600%2C527%2C527%2C43%0A1391040000%2C527%2C527%2C38%0A1391126400%2C527%2C527%2C34%0A1391212800%2C527%2C527%2C31%0A1391299200%2C529%2C529%2C27%0A1391385600%2C529%2C529%2C27%0A1391472000%2C529%2C529%2C27%0A1391558400%2C529%2C529%2C25%0A1391644800%2C529%2C529%2C23%0A1391731200%2C529%2C529%2C21%0A1391817600%2C529%2C529%2C19%0A1391904000%2C529%2C529%2C19%0A1391990400%2C529%2C529%2C19%0A1392076800%2C527%2C529%2C19%0A1392163200%2C527%2C529%2C17%0A1392249600%2C529%2C529%2C15%0A1392336000%2C529%2C529%2C14%0A1392422400%2C528%2C529%2C14%0A1392508800%2C528%2C529%2C13%0A1392595200%2C528%2C529%2C13%0A1392681600%2C527%2C529%2C13%0A1392768000%2C527%2C529%2C13%0A1392854400%2C529%2C529%2C12%0A1392940800%2C528%2C529%2C12%0A1393027200%2C527%2C529%2C11%0A1393113600%2C528%2C529%2C5%0A1393200000%2C528%2C529%2C5%0A1393286400%2C528%2C529%2C5%0A1393372800%2C527%2C529%2C5%0A1393459200%2C528%2C529%2C5%0A1393545600%2C528%2C529%2C5%0A1393632000%2C529%2C529%2C5%0A1393718400%2C529%2C529%2C5%0A1393804800%2C529%2C529%2C5%0A1393891200%2C529%2C529%2C5%0A1393977600%2C529%2C529%2C5%0A1394064000%2C529%2C529%2C5%0A1394150400%2C529%2C529%2C5%0A1394236800%2C529%2C529%2C5%0A1394323200%2C529%2C529%2C5%0A1394409600%2C529%2C529%2C5%0A1394496000%2C528%2C529%2C5%0A1394582400%2C528%2C529%2C5%0A1394668800%2C528%2C529%2C5%0A1394755200%2C528%2C529%2C5%0A1394841600%2C528%2C529%2C5%0A1394928000%2C528%2C529%2C5%0A1395014400%2C528%2C529%2C5%0A1395100800%2C528%2C529%2C5%0A1395187200%2C528%2C529%2C5%0A1395273600%2C528%2C529%2C5%0A1395360000%2C528%2C529%2C5%0A1395446400%2C528%2C529%2C5%0A1395532800%2C528%2C529%2C5%0A1395619200%2C528%2C529%2C5%0A1395705600%2C528%2C529%2C5%0A1395792000%2C528%2C529%2C5%0A1395878400%2C528%2C529%2C5%0A1395964800%2C528%2C529%2C5%0A1396051200%2C528%2C529%2C5%0A1396137600%2C528%2C529%2C5%0A1396224000%2C528%2C529%2C5%0A1396310400%2C528%2C529%2C5%0A1396396800%2C528%2C529%2C5%0A1396483200%2C528%2C529%2C5%0A1396569600%2C528%2C529%2C5%0A1396656000%2C528%2C529%2C5%0A1396742400%2C528%2C529%2C5%0A1396828800%2C528%2C529%2C5%0A1396915200%2C528%2C529%2C5%0A1397001600%2C528%2C529%2C5%0A1397088000%2C528%2C529%2C5%0A1397174400%2C528%2C529%2C5%0A1397260800%2C528%2C529%2C5%0A1397433600%2C528%2C529%2C5%0A1397520000%2C528%2C529%2C5%0A1397606400%2C528%2C529%2C5%0A1397692800%2C528%2C529%2C5%0A1397779200%2C528%2C529%2C5%0A1397865600%2C528%2C529%2C5%0A1397952000%2C528%2C529%2C5%0A1398038400%2C528%2C529%2C5%0A1398124800%2C528%2C529%2C5%0A1398211200%2C528%2C529%2C5%0A1398297600%2C528%2C529%2C5%0A1398384000%2C527%2C529%2C5%0A1398470400%2C527%2C529%2C5%0A1398556800%2C527%2C529%2C5%0A1398643200%2C527%2C529%2C5%0A1398729600%2C527%2C529%2C5%0A1398816000%2C527%2C529%2C5%0A1398902400%2C527%2C529%2C5%0A1398988800%2C527%2C529%2C5%0A1399075200%2C527%2C529%2C5%0A1399161600%2C527%2C529%2C5%0A1399248000%2C527%2C529%2C5%0A1399334400%2C527%2C529%2C5%0A1399420800%2C527%2C529%2C5%0A1399507200%2C527%2C529%2C5%0A1399593600%2C527%2C529%2C5%0A1399680000%2C527%2C529%2C5%0A1399766400%2C526%2C529%2C5%0A1399852800%2C526%2C529%2C5%0A1399939200%2C526%2C529%2C5%0A1400025600%2C526%2C529%2C5%0A1400112000%2C526%2C529%2C5%0A1400112000';
spring15unextracted = '0%2C481%2C0%0A1412640000%2C0%2C481%2C0%0A1412726400%2C0%2C481%2C0%0A1412726400%2C0%2C481%2C0%0A1412812800%2C0%2C481%2C0%0A1412899200%2C0%2C481%2C0%0A1412985600%2C0%2C481%2C0%0A1413072000%2C0%2C481%2C0%0A1413158400%2C0%2C481%2C0%0A1413244800%2C0%2C481%2C0%0A1413331200%2C0%2C481%2C0%0A1413417600%2C0%2C481%2C0%0A1413504000%2C0%2C481%2C0%0A1413590400%2C0%2C481%2C0%0A1413676800%2C0%2C481%2C0%0A1413763200%2C0%2C481%2C0%0A1413849600%2C55%2C481%2C0%0A1413936000%2C65%2C481%2C0%0A1414022400%2C74%2C481%2C0%0A1414108800%2C77%2C481%2C0%0A1414195200%2C105%2C481%2C0%0A1414368000%2C107%2C481%2C0%0A1414454400%2C111%2C481%2C0%0A1414540800%2C111%2C481%2C0%0A1414627200%2C141%2C481%2C0%0A1414713600%2C258%2C481%2C0%0A1414800000%2C337%2C481%2C1%0A1415059200%2C425%2C481%2C50%0A1415059200%2C425%2C481%2C50%0A1415145600%2C420%2C481%2C50%0A1415232000%2C425%2C425%2C50%0A1415318400%2C425%2C425%2C50%0A1415404800%2C425%2C425%2C50%0A1415491200%2C425%2C425%2C50%0A1415577600%2C425%2C425%2C50%0A1415664000%2C425%2C425%2C50%0A1415750400%2C425%2C425%2C50%0A1415836800%2C422%2C425%2C50%0A1415923200%2C425%2C425%2C50%0A1416009600%2C425%2C425%2C50%0A1416096000%2C425%2C425%2C50%0A1416182400%2C424%2C425%2C50%0A1416268800%2C424%2C425%2C50%0A1416355200%2C425%2C425%2C50%0A1416441600%2C425%2C425%2C50%0A1416528000%2C424%2C425%2C50%0A1416614400%2C425%2C425%2C49%0A1416700800%2C425%2C425%2C49%0A1416787200%2C424%2C425%2C50%0A1416873600%2C425%2C425%2C50%0A1416960000%2C425%2C425%2C50%0A1417046400%2C425%2C425%2C50%0A1417132800%2C425%2C425%2C50%0A1417219200%2C425%2C425%2C50%0A1417305600%2C425%2C425%2C50%0A1417392000%2C425%2C425%2C50%0A1417478400%2C425%2C425%2C50%0A1417564800%2C425%2C425%2C50%0A1417651200%2C422%2C425%2C50%0A1417737600%2C429%2C429%2C40%0A1417824000%2C431%2C432%2C40%0A1417910400%2C431%2C432%2C40%0A1417996800%2C431%2C432%2C40%0A1418083200%2C454%2C475%2C40%0A1418169600%2C475%2C475%2C40%0A1418256000%2C475%2C475%2C40%0A1418256000';
% Extracting data
spring14Data = ExtractData(spring14unextracted);
spring15Data = ExtractData(spring15unextracted);

%% Plotting Registration
% The numbers of people enrolled and waitlisted

figure;
subplot(2,1,1);
PlotClassData(spring14Data);
title('Spring 2014 Math 54 Enrollment');

subplot(2,1,2);
PlotClassData(spring15Data);
title('Spring 2015 Math 54 Enrollment');

%% Plotting Percent Registered

figure;
spring14percentEnrolled = spring14Data.Enrollment ./ spring14Data.Limit;
subplot(2,1,1);
plot(1:length(spring14percentEnrolled),spring14percentEnrolled,1:length(spring14percentEnrolled),ones(length(spring14percentEnrolled),1),'r:');
xlabel('Days Since Telebears Phase I'); ylabel('Percent Enrollment');
title('Spring 2014 Math 54 Percent Enrollment Over Time');
legend('Spring 2014','Limit','location','best')
axis([0 120 0 1.1])

spring15percentEnrolled = spring15Data.Enrollment ./ spring15Data.Limit;
subplot(2,1,2);
plot(1:length(spring15percentEnrolled),spring15percentEnrolled,1:length(spring15percentEnrolled)+1,ones(length(spring15percentEnrolled)+1,1),'r:');
xlabel('Days Since Telebears Phase I'); ylabel('Percent Enrollment');
title('Spring 2015 Math 54 Percent Enrollment Over Time');
legend('Spring 2015','Limit','location','best')
axis([0 60 0 1.1])

figure;
plot(1:length(spring14percentEnrolled),spring14percentEnrolled,1:length(spring15percentEnrolled),spring15percentEnrolled,'g',1:length(spring14percentEnrolled),ones(length(spring14percentEnrolled),1),'r:');
xlabel('Days Since Telebears Phase I'); ylabel('Percent Enrollment');
title('Spring 2015 and 2014 Math 54 Percent Enrollment Over Time');
legend('Spring 2014','Spring 2015','Limit','location','best')
axis([0 120 0 1.1])
%% Available Seats Over Time

figure;
subplot(2,1,1);
plot(spring14Data.AvailableSeats,'.-');
xlabel('Days Since Telebears Phase I'); ylabel('Available Seats');
title('Spring 2014 Math 54 Available Seats Over Time');

subplot(2,1,2);
plot(spring15Data.AvailableSeats,'.-');
xlabel('Days Since Telebears Phase I'); ylabel('Available Seats');
title('Spring 2015 Math 54 Available Seats Over Time');

figure;
plot(1:length(spring14Data.AvailableSeats),spring14Data.AvailableSeats,'b.-',1:length(spring15Data.AvailableSeats),spring15Data.AvailableSeats,'g.-');
xlabel('Days Since Telebears Phase I'); ylabel('Available Seats');
title('Spring 2015 and 2014 Math 54 Available Seats Over Time');
legend('Spring 2014','Spring 2015','location','best')
%% Finding the Total Amount of Available Seats after Class is Almost Full
% Finding the probability of stumbling upon a seat during open hours.
% Class is almost full if there are only 5 seats available
% Using numerical integration, find the total amount of available seats
% available once there are only 5 seats left.

DayClassAlmostFull2014 = find(spring14Data.AvailableSeats < 5, 1);
DayClassAlmostFull2015 = find(spring15Data.AvailableSeats < 5, 1);

totalSeats2014 = trapz(spring14Data.AvailableSeats(DayClassAlmostFull2014:end));
time2014 = length(spring14Data.Enrollment) - DayClassAlmostFull2014;
averageSeatsPerDay2014 = totalSeats2014/time2014;

totalSeats2015 = trapz(spring15Data.AvailableSeats(DayClassAlmostFull2015:end));
time2015 = length(spring15Data.Enrollment) - DayClassAlmostFull2015;
averageSeatsPerDay2015 = totalSeats2015/time2015;

% After the day that there were 5 seats left, 238 total seats became
% available for that lecture during Spring 2014. However, only 34 seats
% have opened for Spring 2015.
% On average, approximately 3 seats opened each day last year but so far only 1 seat a
% day this year.

%% Statistics of Available Seats when Class is Almost Full
% Using the mean function to find the probability of stumbling upon a seat
% during open hours.  
% Use mean and standard deviation to describe the variation in seats once
% the class is almost full.

[probavail14,avg14,std14] = spring14stats(spring14Data.Enrollment,spring14Data.Limit);
[probavail15,avg15,std15] = spring15stats(spring15Data.Enrollment,spring15Data.Limit);


%% Finding the Rate of Available Seats Filling after Class if Almost Full
% Using numerical differentiation to find how seats fill over time
% Allows predictions for future years of enrollment of rates for seats
% filling.

DayClassAlmostFull2014 = find(spring14Data.AvailableSeats < 5, 1);
DayClassAlmostFull2015 = find(spring15Data.AvailableSeats < 5, 1);

rateAvailableSeats2014 = diff(spring14Data.AvailableSeats);
rateAvailableSeats2015 = diff(spring15Data.AvailableSeats);

daysSeatsAvailable2014 = numel(find(rateAvailableSeats2014(DayClassAlmostFull2014:end) > 0));
daysSeatsAvailable2015 = numel(find(rateAvailableSeats2015(DayClassAlmostFull2015:end) > 0));

% There is a wide difference between the amount of days where seats became
% available in 2014 and 2015, due to the difference in professors teaching
% the class. In 2014, the professors for the lectures were more evened out
% while in 2015 there is high demand for this one lecture we are analyzing.

%%
% Spring 14
figure
mydata=spring14Data.Enrollment(1:end);
mydatadiff=[0;diff(mydata)];
plot(mydatadiff,'g')
hold on
plot(mydata,'b')
plot(zeros(length(mydata),1),'r:')
plot(find(mydatadiff<0),-20*ones(length(find(mydatadiff<0)),1),'m^','MarkerFaceColor','c')
xlabel('days')
ylabel('Enrollment')
legend('Change in Enrollment','Enrollment','Zero','Days People Dropped','location','best')
title('Enrollment and Change in Enrollment for Spring 14')
% Spring 15
mydata1=spring15Data.Enrollment(1:end);
mydatadiff1=[0;diff(mydata1)];
figure
plot(mydatadiff1,'g')
hold on
plot(mydata1,'b')
plot(zeros(length(mydata1),1),'r:')
plot(find(mydatadiff1<0),-20*ones(length(find(mydatadiff1<0)),1),'m^','MarkerFaceColor','c')
xlabel('days')
ylabel('Enrollment')
legend('Change in Enrollment','Enrollment','Zero','Days People Dropped','location','best')
title('Enrollment and Change in Enrollment for Spring 15')